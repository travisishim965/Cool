<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>99 Nights: Character View Simulator V16.9 (Giga-Integrated)</title>
    <style>
        /* ================================================================
           [99 NIGHTS] SYSTEM CSS - V16.9
           ================================================================ */
        @import url('https://fonts.googleapis.com/css2?family=Monoton&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        :root {
            --neon-green: #00ff00;
            --neon-blue: #00ffff;
            --neon-pink: #ff00ff;
            --bad-green: #adff2f; /* Sickly Lime for Meowl */
            --murky-green: #1a2e00;
            --blood-red: #500000;
            --dark-bg: #030303;
        }

        body {
            font-family: 'Courier New', monospace;
            background-color: #000000;
            color: var(--neon-green);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            margin: 0;
            transition: background-color 1.2s ease;
            overflow-x: hidden;
        }

        /* --- THREAT ALERT ANIMATIONS --- */
        body.elephant-active {
            animation: bg-red-pulse 2s infinite alternate ease-in-out;
        }
        @keyframes bg-red-pulse {
            from { background-color: #000; }
            to { background-color: var(--blood-red); }
        }

        body.meowl-active {
            animation: bg-bad-green-pulse 2s infinite alternate ease-in-out;
        }
        @keyframes bg-bad-green-pulse {
            from { background-color: #000; }
            to { background-color: var(--murky-green); }
        }

        #game-container {
            width: 95%;
            max-width: 950px;
            background-color: #0d0d0d;
            border: 4px solid var(--neon-green);
            padding: 25px;
            position: relative; 
            box-shadow: 0 0 40px rgba(0, 255, 0, 0.1);
        }

        h1 {
            color: var(--neon-blue);
            text-align: center;
            text-shadow: 0 0 10px var(--neon-green);
            font-family: 'Monoton', cursive;
            font-size: 3em;
            margin: 10px 0;
        }

        /* --- UI COMPONENTS --- */
        .progress-bar {
            width: 100%;
            background-color: #222;
            border: 1px solid var(--neon-green);
            height: 30px;
            margin-bottom: 12px;
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            position: absolute;
            left: 0;
            top: 0;
            transition: width 0.4s cubic-bezier(0.1, 0.7, 0.1, 1);
        }
        
        .fill-hp { background: linear-gradient(90deg, #800, #f00); }
        .fill-hg { background: linear-gradient(90deg, #840, #f90); }
        .fill-kn { background: linear-gradient(90deg, #004488, #00ffff); }
        
        .progress-label {
            position: absolute;
            width: 100%;
            text-align: center;
            line-height: 30px;
            z-index: 5;
            font-weight: bold;
            font-family: 'Orbitron';
            font-size: 0.8em;
            color: #fff;
            text-shadow: 1px 1px 2px #000;
        }

        #visual-scene {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
            border: 2px solid var(--neon-blue);
            padding: 20px;
            background: rgba(0,0,0,0.5);
        }
        
        .character-box {
            text-align: center;
            padding: 15px;
            border: 1px solid var(--neon-green);
            background: #1a1a1a;
            height: 280px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .char-icon { font-size: 90px; margin-bottom: 15px; }

        #log {
            height: 180px;
            overflow-y: auto;
            border: 1px solid var(--neon-green);
            padding: 10px;
            margin-bottom: 20px;
            background: #000800;
            font-size: 0.85em;
            color: var(--neon-green);
        }

        .btn-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }

        button {
            padding: 12px 20px;
            background: #001a00;
            color: var(--neon-green);
            border: 2px solid var(--neon-green);
            font-family: 'Orbitron';
            cursor: pointer;
            min-width: 160px;
            transition: 0.2s;
        }

        button:hover {
            background: var(--neon-green);
            color: #000;
        }

        /* --- ACHIEVEMENT KERNEL --- */
        #achievement-kernel {
            margin-top: 25px;
            border-top: 2px solid var(--neon-blue);
            padding-top: 20px;
        }
        
        .achieve-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .ach-item {
            border: 1px solid #333;
            padding: 10px;
            font-size: 0.55em;
            text-align: center;
            color: #444;
            font-family: 'Press Start 2P';
            line-height: 1.4;
        }
        
        .ach-unlocked {
            color: #ffff00;
            border-color: #ffff00;
            background: #1a1a00;
        }

        /* --- FULL SCREEN OVERLAYS --- */
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.98);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 5000;
            text-align: center;
        }
        
        #victory-screen h1 { font-size: 4em; color: var(--neon-blue); }
        #game-over-screen h1 { font-family: 'Press Start 2P'; font-size: 4em; color: #f00; }

        #combat-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 2000;
            display: none;
            flex-direction: column;
            align-items: center;
            padding: 40px;
            box-sizing: border-box;
        }

        .message-success { color: #00ff00; }
        .message-fail { color: #ff0000; }
        .message-event { color: #ffff00; }
    </style>
</head>
<body id="sys-body">

<div id="game-container">
    <h1>[99Nights]</h1>
    <p style="text-align: center; color: var(--neon-blue); font-family: 'Orbitron'; letter-spacing: 4px;">
        NIGHT: <span id="night-val">0</span> | AP: <span id="ap-val">0</span>
    </p>

    <div id="visual-scene">
        <div class="character-box">
            <div class="char-icon" id="p-sprite">ðŸ‘¤</div>
            <h3 id="p-name" style="font-family:'Press Start 2P'; font-size: 0.7em;">INITIALIZING...</h3>
            <p style="font-size: 0.8em;">GEAR: <span id="gear-val">100</span>%</p>
        </div>
        <div class="character-box">
            <div class="char-icon" id="e-sprite">?</div>
            <h3 id="e-name" style="font-family:'Press Start 2P'; font-size: 0.7em;">SCANNING...</h3>
            <p id="e-status" style="font-size: 0.8em; color: var(--neon-pink);">---</p>
        </div>
    </div>

    <div class="progress-bar">
        <div class="progress-fill fill-hp" id="bar-hp"></div>
        <div class="progress-label" id="lbl-hp">VITALITY: 100%</div>
    </div>
    <div class="progress-bar">
        <div class="progress-fill fill-hg" id="bar-hg"></div>
        <div class="progress-label" id="lbl-hg">METABOLISM: 100%</div>
    </div>
    <div class="progress-bar">
        <div class="progress-fill fill-kn" id="bar-kn"></div>
        <div class="progress-label" id="lbl-kn">COGNITION: 0/500</div>
    </div>

    <div id="log">
        <p class="message-event">Kernel Online. Click BOOT to begin Neural Link.</p>
    </div>

    <div class="btn-grid" id="ui-controls" style="display:none;">
        <button onclick="Kernel.action('fight')">NEURAL CLASH</button>
        <button onclick="Kernel.action('eat')">EAT (1 AP)</button>
        <button onclick="Kernel.action('scavenge')">SCAVENGE (1 AP)</button>
        <button onclick="Kernel.action('study')">STUDY (1 AP)</button>
    </div>

    <div id="ui-init" style="text-align:center;">
        <button style="width:100%; font-size:1.5em;" onclick="Kernel.boot()">BOOT NEURAL LINK</button>
    </div>

    <div id="achievement-kernel">
        <div class="achieve-grid">
            <div class="ach-item" id="ach-1">NIGHT 1<br>AWAKENED</div>
            <div class="ach-item" id="ach-2">MEOWL<br>DEFEATED</div>
            <div class="ach-item" id="ach-3">ELEPHANT<br>TAMED</div>
            <div class="ach-item" id="ach-4">NIGHT 50<br>SURVIVED</div>
            <div class="ach-item" id="ach-5">COG GOD<br>500 KN</div>
            <div class="ach-item" id="ach-6">FULL GEAR<br>REPAIRED</div>
        </div>
    </div>

    <div id="combat-modal">
        <h2 style="color:var(--neon-pink); font-family:'Monoton'; font-size: 3em;">RESOLVER</h2>
        <div style="width:90%; margin:30px 0;">
            <div class="progress-bar"><div class="progress-fill fill-hp" id="c-p-hp"></div><div class="progress-label">SURVIVOR</div></div>
            <div class="progress-bar"><div class="progress-fill" id="c-e-hp" style="background:purple;"></div><div class="progress-label" id="c-e-name">THREAT</div></div>
        </div>
        <div id="combat-log" style="width:90%; height:140px; border:1px solid var(--neon-pink); color:var(--neon-pink); background:#100010; padding:10px; overflow-y:auto; margin-bottom:20px;"></div>
        <div class="btn-grid">
            <button onclick="Kernel.clash('PUNCH')">PUNCH ðŸ‘Š</button>
            <button onclick="Kernel.clash('DODGE')">DODGE ðŸ¤¸</button>
        </div>
    </div>

    <div id="victory-screen" class="overlay">
        <h1>VICTORY! YOU WIN!</h1>
        <p style="color:#fff; font-family:'Orbitron';">99 NIGHTS COMPLETED. ASCENSION REACHED.</p>
        <button onclick="location.reload()">RE-BOOT</button>
    </div>
    <div id="game-over-screen" class="overlay">
        <h1>GAME OVER</h1>
        <p id="fail-reason" style="color:#aaa; font-family:'Orbitron';">CONNECTION TERMINATED</p>
        <button onclick="location.reload()">RE-TRY</button>
    </div>
</div>

<script>
/* ================================================================
   [99 NIGHTS] KERNEL LOGIC - V16.9
   ================================================================ */

const Kernel = {
    state: {
        night: 0, hp: 100, hg: 100, gear: 100, kn: 0, ap: 2,
        isRunning: false, threats: [],
        ach: { meowl: false, elephant: false },
        combat: null
    },

    boot: function() {
        document.getElementById('ui-init').style.display = 'none';
        document.getElementById('ui-controls').style.display = 'flex';
        
        const icons = ["ðŸ¦Š", "ðŸ¦¦", "ðŸ¦”", "ðŸ¦Ž"];
        document.getElementById('p-sprite').innerText = icons[Math.floor(Math.random()*4)];
        document.getElementById('p-name').innerText = "UNIT_PRIME";
        
        this.state.isRunning = true;
        this.log("System Initialized. Searching for threats...", "message-success");
        this.nextNight();
        this.startDecay();
    },

    log: function(m, cl = "") {
        const l = document.getElementById('log');
        l.innerHTML = `<p class="${cl}">[NIGHT ${this.state.night}] ${m}</p>` + l.innerHTML;
    },

    sync: function() {
        document.getElementById('night-val').innerText = this.state.night;
        document.getElementById('ap-val').innerText = this.state.ap;
        document.getElementById('gear-val').innerText = Math.round(this.state.gear);
        
        document.getElementById('bar-hp').style.width = this.state.hp + "%";
        document.getElementById('lbl-hp').innerText = `VITALITY: ${Math.round(this.state.hp)}%`;
        document.getElementById('bar-hg').style.width = this.state.hg + "%";
        document.getElementById('lbl-hg').innerText = `METABOLISM: ${Math.round(this.state.hg)}%`;
        document.getElementById('bar-kn').style.width = (this.state.kn/500*100) + "%";
        document.getElementById('lbl-kn').innerText = `COGNITION: ${this.state.kn}/500`;

        const body = document.getElementById('sys-body');
        if(this.state.threats.length > 0) {
            const t = this.state.threats[0];
            document.getElementById('e-sprite').innerText = t.icon;
            document.getElementById('e-name').innerText = t.name;
            document.getElementById('e-status').innerText = "THREAT ACTIVE";
            
            body.className = '';
            if(t.name === "STRAWBERRY ELEPHANT") body.classList.add('elephant-active');
            if(t.name === "MEOWL") body.classList.add('meowl-active');
        } else {
            body.className = '';
            document.getElementById('e-sprite').innerText = "âœ…";
            document.getElementById('e-name').innerText = "CLEAR";
        }

        this.updateAchievements();
        if(this.state.hp <= 0) this.end(false, "VITALITY FAILURE");
        if(this.state.night >= 99) this.end(true);
    },

    nextNight: function() {
        this.state.night++;
        this.state.ap = 2;
        
        let roll = Math.random();
        let t;
        if(roll < 0.12) t = { name: "STRAWBERRY ELEPHANT", hp: 600, icon: "ðŸ˜ðŸ“" };
        else if(roll < 0.25) t = { name: "MEOWL", hp: 350, icon: "ðŸ¦‰ðŸˆ" };
        else t = { name: "BRAINROT DRONE", hp: 120, icon: "ðŸ§ " };
        
        this.state.threats.push(t);
        this.log(`${t.name} entered the sector!`, "message-fail");
        this.sync();
    },

    action: function(type) {
        if(!this.state.isRunning) return;
        if(this.state.ap <= 0 && type !== 'fight') return;

        if(type === 'fight') {
            if(this.state.threats.length > 0) this.openCombat();
            return;
        }

        if(type === 'eat') this.state.hg = Math.min(100, this.state.hg + 40);
        if(type === 'study') this.state.kn = Math.min(500, this.state.kn + 50);
        if(type === 'scavenge') {
            this.state.gear = Math.min(100, this.state.gear + 30);
            this.state.hp = Math.min(100, this.state.hp + 10);
        }

        this.state.ap--;
        if(this.state.ap <= 0) {
            this.log("Energy depleted. Cycle rotating...");
            setTimeout(() => this.nextNight(), 1000);
        }
        this.sync();
    },

    openCombat: function() {
        const t = this.state.threats[0];
        this.state.combat = { p: 100, e: t.hp, max: t.hp, t: t };
        document.getElementById('combat-modal').style.display = 'flex';
        document.getElementById('c-e-name').innerText = t.name;
        document.getElementById('combat-log').innerHTML = "<p>Combat Initialized...</p>";
        this.syncCombat();
    },

    syncCombat: function() {
        document.getElementById('c-p-hp').style.width = this.state.combat.p + "%";
        document.getElementById('c-e-hp').style.width = (this.state.combat.e/this.state.combat.max*100) + "%";
    },

    clash: function(pMove) {
        const eMove = Math.random() > 0.5 ? "PUNCH" : "DODGE";
        const clog = document.getElementById('combat-log');
        
        let msg = "";
        if(pMove === "DODGE" && eMove === "DODGE") {
            msg = "STALEMATE: Both units evaded.";
        } else if(pMove === "PUNCH" && eMove === "PUNCH") {
            this.state.combat.e -= 40;
            this.state.combat.p -= 20;
            msg = "CLASH: Direct collision. Both units damaged.";
        } else if(pMove === "PUNCH" && eMove === "DODGE") {
            if(Math.random() < 0.7) {
                msg = "MISS: The threat successfully evaded.";
            } else {
                this.state.combat.e -= 60;
                msg = "CRITICAL: Caught them mid-dodge!";
            }
        } else {
            this.state.combat.e -= 25;
            msg = "COUNTER: You landed a precision strike.";
        }

        clog.innerHTML = `<p>> ${msg}</p>` + clog.innerHTML;
        this.syncCombat();

        if(this.state.combat.p <= 0) this.end(false, "NEURAL FATALITY");
        if(this.state.combat.e <= 0) {
            const def = this.state.threats.shift();
            if(def.name === "MEOWL") this.state.ach.meowl = true;
            if(def.name === "STRAWBERRY ELEPHANT") this.state.ach.elephant = true;
            this.state.ap++;
            document.getElementById('combat-modal').style.display = 'none';
            this.log(`${def.name} Expelled. AP Restored.`, "message-success");
            this.sync();
        }
    },

    updateAchievements: function() {
        if(this.state.night >= 1) document.getElementById('ach-1').classList.add('ach-unlocked');
        if(this.state.ach.meowl) document.getElementById('ach-2').classList.add('ach-unlocked');
        if(this.state.ach.elephant) document.getElementById('ach-3').classList.add('ach-unlocked');
        if(this.state.night >= 50) document.getElementById('ach-4').classList.add('ach-unlocked');
        if(this.state.kn >= 500) document.getElementById('ach-5').classList.add('ach-unlocked');
        if(this.state.gear >= 100) document.getElementById('ach-6').classList.add('ach-unlocked');
    },

    startDecay: function() {
        setInterval(() => {
            if(this.state.isRunning) {
                this.state.hg -= 1.2;
                if(this.state.hg <= 0) { this.state.hg = 0; this.state.hp -= 2; }
                this.sync();
            }
        }, 5000);
    },

    end: function(win, reason) {
        this.state.isRunning = false;
        if(win) {
            document.getElementById('victory-screen').style.display = 'flex';
        } else {
            document.getElementById('fail-reason').innerText = reason;
            document.getElementById('game-over-screen').style.display = 'flex';
        }
    }
};
</script>
</body>
</html>
